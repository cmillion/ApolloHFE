"""Utility module for working with Apollo Heat Flow Experiment data."""

import numpy as np
import matplotlib.pyplot as plt
import pandas as pd
plt.ion() # Don't lock up the terminal when displaying a plot.

ipath = '../../heat_flow_experiment_hfe/data/PSPG-00752_1284752997_APOLLO15_HDF_1/'

datafiles = ['a15p1.file_1','a15p1.file_3','a15p1.file_5','a15p2.file_2',
             'a15p2.file_4','a15p1.file_2','a15p1.file_4','a15p2.file_1',
             'a15p2.file_3','a15p2.file_5']

data = {}
for f in datafiles:
    mission = f[:3]
    if not mission in data.keys():
        data[mission] = {}
    probe = f[3:5]
    if not probe in data[mission].keys():
        data[mission][probe] = {}
    sensor = int(f[-1:])
    columns = (['Time','HTR','TREF','TC1','TC2','TC3','TC4']
                                    if sensor is '3' else ['Time','T','dT'])
    data[mission][probe][sensor] = pd.read_csv('{i}{f}'.format(
        i=ipath,f=f),skiprows=1,names=columns,delim_whitespace=True,
                                skipinitialspace=True)#,skipfooter=1)

def plot_rollovers():
    # The signal is rolling over at T of 2/2**n
    plt.axhline(y=0.0, color='r', linestyle='-')
    for p in range(10):
        plt.axhline(y=-2./2**p, color='r', linestyle='-')

# Don't even look at entries with bad values.
ix = np.where((np.array(data['a15']['p1'][1]['Time'])!=-9999) &
              (np.array(data['a15']['p1'][1]['T'])!=-9999) &
              (np.array(data['a15']['p1'][1]['dT'])!=-9999))
Time = np.array(data['a15']['p1'][1]['Time'])[ix]
T = np.array(data['a15']['p1'][1]['T'])[ix]
dT = np.array(data['a15']['p1'][1]['dT'])[ix]

# # plt.figure()
# # plt.plot(Time,T,'.')
# # plt.xlabel('Time')
# # plt.ylabel('Temp')
# # plot_rollovers()
# # plt.ylim([-5,5])
plt.close('all')
plt.figure()
plt.plot(Time,T,'x')
plt.xlabel('Time')
plt.ylabel('Temp')


""" Manually assign rollovers to data.
 Note: Values >0 are never corrected. These have been flagged with a comment.
 Note: The ~ few data points below zero are always a little bit ambiguous as
       to which correction to use. I have assigned these corrections using
       "best fit" by eye. Such points have been flagged with a comment. You may
       wish to omit them from analysis.
"""
bins=np.array([-2./2**n for n in range(10)])
# [-2., -1., -0.5, -0.25, -0.125, -0.0625, -0.0313, -0.0156, -0.008, -0.004]
T[0:31] = 2*bins[1]-T[0:31]
T[31:150] = 2*bins[0]-T[31:150]
T[150:208] = 2*bins[1]-T[150:208]
T[208:229] = 2*bins[2]-T[208:229]
T[229:235] = 2*bins[3]-T[229:235]
T[235:238] = 2*bins[4]-T[235:238]
T[238:239] = 2*bins[5]-T[238:239]
T[239:240] = 2*bins[6]-T[239:240]
T[240:241] = 2*bins[7]-T[240:241]
T[241:1494] = T[241:1494] # >0
T[1494:1495] = T[1494:1495] # Ambiguous.
T[1495:1496] = 2*bins[-1]-T[1495:1496]
T[1496:1499] = 2*bins[-2]-T[1496:1499]
T[1499:1504] = 2*bins[-3]-T[1499:1504]
T[1504:1511] = 2*bins[-4]-T[1504:1511]
T[1511:1530] = 2*bins[-5]-T[1511:1530]
T[1530:1569] = 2*bins[-6]-T[1530:1569]
T[1569:1648] = 2*bins[-7]-T[1569:1648]
T[1648:1954] = 2*bins[-8]-T[1648:1954]
T[1954:2415] = 2*bins[-9]-T[1954:2415]
T[2415:2447] = 2*bins[-8]-T[2415:2447]
T[2447:2459] = 2*bins[-7]-T[2447:2459]
T[2459:2464] = 2*bins[-6]-T[2459:2464]
T[2464:2467] = 2*bins[-5]-T[2464:2467]
T[2467:2468] = 2*bins[-3]-T[2467:2468] # Ambiguous.
T[2468:2990] = T[2468:2990] # >0
T[2990:2991] = T[2990:2991] # Ambiguous.
T[2991:2992] = 2*bins[6]-T[2991:2992] # Ambiguous.
T[2992:2994] = 2*bins[5]-T[2992:2994] # Slightly ambiguous.
T[2994:2999] = 2*bins[4]-T[2994:2999]
T[2999:3008] = 2*bins[3]-T[2999:3008]
T[3008:3028] = 2*bins[2]-T[3008:3028]
T[3028:3090] = 2*bins[1]-T[3028:3090]
T[3090:3146] = 2*bins[0]-T[3090:3146]
T[3146:3228] = 2*bins[1]-T[3146:3228]
T[3228:3250] = 2*bins[2]-T[3228:3250]
T[3250:3258] = 2*bins[3]-T[3250:3258]
T[3258:3263] = 2*bins[4]-T[3258:3263]
T[3263:3266] = 2*bins[5]-T[3263:3266]
T[3266:3267] = 2*bins[6]-T[3266:3267] # Ambiguous.
T[3267:3760] = T[3267:3760] # >0
T[3760:3761] = 2*bins[7]-T[3760:3761] # Ambiguous.
T[3761:3762] = 2*bins[6]-T[3761:3762] # Ambiguous.
T[3762:3764] = 2*bins[5]-T[3762:3764]
T[3764:3767] = 2*bins[4]-T[3764:3767]
T[3767:3776] = 2*bins[3]-T[3767:3776]
T[3776:3793] = 2*bins[2]-T[3776:3793]
T[3793:3843] = 2*bins[1]-T[3793:3843]
T[3843:3981] = 2*bins[0]-T[3843:3981]
T[3981:4036] = 2*bins[1]-T[3981:4036]
T[4036:4050] = 2*bins[2]-T[4036:4050]
T[4050:4056] = 2*bins[3]-T[4050:4056]
T[4056:4059] = 2*bins[4]-T[4056:4059]
T[4059:4061] = 2*bins[5]-T[4059:4061] # Slightly ambiguous.
T[4061:4062] = 2*bins[6]-T[4061:4062] # Slightly ambiguous.
T[4062:4063] = 2*bins[8]-T[4062:4063] # Ambiguous
T[4063:4524] = T[4063:4524] # >0
T[4524:4525] = 2*bins[-1]-T[4524:4525] # Very ambiguous.
T[4525:4526] = 2*bins[-4]-T[4525:4526] # Ambiguous.
T[4526:4527] = 2*bins[-5]-T[4526:4527]
T[4527:4529] = 2*bins[-5]-T[4527:4529]
T[4529:4533] = 2*bins[-6]-T[4529:4533]
T[4533:4542] = 2*bins[-7]-T[4533:4542]
T[4542:4559] = 2*bins[-8]-T[4542:4559]
T[4559:4601] = 2*bins[-9]-T[4559:4601]
T[4601:4775] = 2*bins[0]-T[4601:4775]
T[4775:4821] = 2*bins[1]-T[4775:4821]
T[4821:4833] = 2*bins[2]-T[4821:4833]
T[4833:4840] = 2*bins[3]-T[4833:4840]
T[4840:4845] = 2*bins[4]-T[4840:4845]
T[4845:4847] = 2*bins[5]-T[4845:4847]
T[4847:4848] = 2*bins[6]-T[4847:4848] # Slightly ambiguous.
T[4848:4849] = 2*bins[7]-T[4848:4849] # Slightly ambiguous.
T[4849:5295] = T[4849:5295] # >0
T[5295:5296] = 2*bins[-3]-T[5295:5296] # Ambiguous.
T[5296:5297] = 2*bins[-4]-T[5296:5297] # Ambiguous.
T[5297:5299] = 2*bins[-5]-T[5297:5299]
T[5299:5303] = 2*bins[-6]-T[5299:5303]
T[5303:5310] = 2*bins[-7]-T[5303:5310]
T[5310:5327] = 2*bins[-8]-T[5310:5327]
T[5327:5364] = 2*bins[-9]-T[5327:5364]
T[5364:5569] = 2*bins[0]-T[5364:5569]
T[5569:5605] = 2*bins[1]-T[5569:5605]
T[5605:5619] = 2*bins[2]-T[5605:5619]
T[5619:5628] = 2*bins[3]-T[5619:5628]
T[5628:5635] = 2*bins[4]-T[5628:5635]
T[5635:5638] = 2*bins[5]-T[5635:5638]
T[5638:5639] = 2*bins[6]-T[5638:5639] # Ambiguous.
T[5639:5640] = 2*bins[8]-T[5639:5640] # Ambiguous.
T[5640:6056] = T[5640:6056] # >0
T[6056:6057] = 2*bins[-1]-T[6056:6057] # Very ambiguous.
T[6057:6058] = 2*bins[-4]-T[6057:6058] # Ambiguous.
T[6058:6060] = 2*bins[-5]-T[6058:6060]
T[6060:6065] = 2*bins[-6]-T[6060:6065]
T[6065:6071] = 2*bins[-7]-T[6065:6071]
T[6071:6085] = 2*bins[-8]-T[6071:6085]
T[6085:6120] = 2*bins[-9]-T[6085:6120]
T[6120:6327] = 2*bins[0]-T[6120:6327]
T[6327:6355] = 2*bins[1]-T[6327:6355]
T[6355:6371] = 2*bins[2]-T[6355:6371]
T[6371:6381] = 2*bins[3]-T[6371:6381]
T[6381:6385] = 2*bins[4]-T[6381:6385]
T[6385:6388] = 2*bins[5]-T[6385:6388]
T[6388:6390] = 2*bins[6]-T[6388:6390]
T[6390:6391] = 2*bins[7]-T[6390:6391]
T[6391:6392] = 2*bins[8]-T[6391:6392] # Ambiguous.
T[6392:7066] = T[6392:7066] # >0
T[7066:7067] = 2*bins[-3]-T[7066:7067] # Ambiguous.
T[7067:7068] = 2*bins[-4]-T[7067:7068] # Ambiguous.
T[7068:7070] = 2*bins[-5]-T[7068:7070]
T[7070:7074] = 2*bins[-6]-T[7070:7074]
T[7074:7081] = 2*bins[-7]-T[7074:7081]
T[7081:7096] = 2*bins[-8]-T[7081:7096]
T[7096:7132] = 2*bins[-9]-T[7096:7132]
T[7132:7355] = 2*bins[0]-T[7132:7355]
T[7355:7380] = 2*bins[1]-T[7355:7380]
T[7380:7398] = 2*bins[2]-T[7380:7398]
T[7398:7411] = 2*bins[3]-T[7398:7411]
T[7411:7419] = 2*bins[4]-T[7411:7419]
T[7419:7421] = 2*bins[5]-T[7419:7421]
T[7421:7424] = 2*bins[6]-T[7421:7424]
T[7424:7425] = 2*bins[-3]-T[7424:7425] # Ambiguous.
T[7425:8154] = T[7425:8154] # >0
T[8154:8155] = 2*bins[-1]-T[8154:8155] # Ambiguous.
T[8155:8156] = 2*bins[-4]-T[8155:8156] # Ambiguous.
T[8156:8158] = 2*bins[-5]-T[8156:8158]
T[8158:8162] = 2*bins[-6]-T[8158:8162]
T[8162:8169] = 2*bins[-7]-T[8162:8169]
T[8169:8186] = 2*bins[-8]-T[8169:8186]
T[8186:8220] = 2*bins[-9]-T[8186:8220]
T[8220:8463] = 2*bins[0]-T[8220:8463]
T[8463:8488] = 2*bins[1]-T[8463:8488]
T[8488:8508] = 2*bins[2]-T[8488:8508]
T[8508:8521] = 2*bins[3]-T[8508:8521]
T[8521:8528] = 2*bins[4]-T[8521:8528]
T[8528:8531] = 2*bins[5]-T[8528:8531]
T[8531:8533] = 2*bins[6]-T[8531:8533]
T[8533:8534] = 2*bins[7]-T[8533:8534]
T[8534:8535] = 2*bins[8]-T[8534:8535] # Ambiguous.
T[8535:8911] = T[8535:8911] # >0
T[8911:8912] = 2*bins[-1]-T[8911:8912] # Ambiguous.
T[8912:8913] = 2*bins[-4]-T[8912:8913] # Ambiguous.
T[8913:8915] = 2*bins[-5]-T[8913:8915]
T[8915:8919] = 2*bins[-6]-T[8915:8919]
T[8919:8927] = 2*bins[-7]-T[8919:8927]
T[8927:8943] = 2*bins[-8]-T[8927:8943]
T[8943:8977] = 2*bins[1]-T[8943:8977]
T[8977:9217] = 2*bins[0]-T[8977:9217]
T[9217:9247] = 2*bins[1]-T[9217:9247]
T[9247:9267] = 2*bins[2]-T[9247:9267]
T[9267:9280] = 2*bins[3]-T[9267:9280]
T[9280:9288] = 2*bins[4]-T[9280:9288]
T[9288:9292] = 2*bins[5]-T[9288:9292]
T[9292:9294] = 2*bins[6]-T[9292:9294]
T[9294:9295] = 2*bins[7]-T[9294:9295] # Ambiguous.
T[9295:9296] = 2*bins[-1]-T[9295:9296] # Ambiguous.
T[9296:9670] = T[9296:9670] # >0
T[9670:9671] = 2*bins[-3]-T[9670:9671] # Ambiguous.
T[9671:9672] = 2*bins[-4]-T[9671:9672] # Ambiguous.
T[9672:9673] = 2*bins[-5]-T[9672:9673]
T[9673:9677] = 2*bins[-6]-T[9673:9677]
T[9677:9686] = 2*bins[-7]-T[9677:9686]
T[9686:9705] = 2*bins[-8]-T[9686:9705]
T[9705:9739] = 2*bins[-9]-T[9705:9739]
T[9739:9975] = 2*bins[0]-T[9739:9975]
T[9975:10000] = 2*bins[1]-T[9975:10000]
T[10000:10020] = 2*bins[2]-T[10000:10020]
T[10020:10032] = 2*bins[3]-T[10020:10032]
T[10032:10039] = 2*bins[4]-T[10032:10039]
T[10039:10043] = 2*bins[5]-T[10039:10043]
T[10043:10044] = 2*bins[7]-T[10043:10044] # Ambiguous.
T[10044:10427] = T[10044:10427] # >0
T[10427:10428] = 2*bins[-3]-T[10427:10428] # Ambiguous.
T[10428:10430] = 2*bins[-5]-T[10428:10430]
T[10430:10434] = 2*bins[-6]-T[10430:10434]
T[10434:10442] = 2*bins[-7]-T[10434:10442]
T[10442:10460] = 2*bins[-8]-T[10442:10460]
T[10460:10496] = 2*bins[-9]-T[10460:10496]
T[10496:10728] = 2*bins[0]-T[10496:10728]
T[10728:10754] = 2*bins[1]-T[10728:10754]
T[10754:10775] = 2*bins[2]-T[10754:10775]
T[10775:10788] = 2*bins[3]-T[10775:10788]
T[10788:10795] = 2*bins[4]-T[10788:10795]
T[10795:10799] = 2*bins[5]-T[10795:10799]
T[10799:10800] = 2*bins[6]-T[10799:10800]
T[10800:10801] = 2*bins[7]-T[10800:10801] # Ambiguous.
T[10801:10802] = 2*bins[7]-T[10801:10802] # Ambiguous.
T[10802:10803] = 2*bins[9]-T[10802:10803] # Ambiguous.
T[10803:11180] = T[10803:11180] # >0
T[11180:11181] = 2*bins[-4]-T[11180:11181] # Ambiguous.
T[11181:11183] = 2*bins[-5]-T[11181:11183]
T[11183:11187] = 2*bins[-6]-T[11183:11187]
T[11187:11195] = 2*bins[-7]-T[11187:11195]
T[11195:11213] = 2*bins[-8]-T[11195:11213]
T[11213:11250] = 2*bins[-9]-T[11213:11250]
T[11250:11494] = 2*bins[0]-T[11250:11494]
T[11494:11526] = 2*bins[1]-T[11494:11526]
T[11526:11541] = 2*bins[2]-T[11526:11541]
T[11541:11554] = 2*bins[3]-T[11541:11554]
T[11554:11561] = 2*bins[4]-T[11554:11561]
T[11561:11565] = 2*bins[5]-T[11561:11565]
T[11565:11567] = 2*bins[6]-T[11565:11567]
T[11567:11568] = 2*bins[7]-T[11567:11568] # Ambiguous.
T[11568:11569] = 2*bins[8]-T[11568:11569] # Ambiguous.
T[11569:11961] = T[11569:11961] # >0
T[11961:11962] = 2*bins[-3]-T[11961:11962] # Ambiguous.
T[11962:11963] = 2*bins[-4]-T[11962:11963] # Ambiguous.
T[11963:11965] = 2*bins[-5]-T[11963:11965]
T[11965:11968] = 2*bins[-6]-T[11965:11968]
T[11968:11976] = 2*bins[-7]-T[11968:11976]
T[11976:11993] = 2*bins[-8]-T[11976:11993]
T[11993:12033] = 2*bins[-9]-T[11993:12033]
T[12033:12246] = 2*bins[0]-T[12033:12246]
T[12246:12275] = 2*bins[1]-T[12246:12275]
T[12275:12293] = 2*bins[2]-T[12275:12293]
T[12293:12305] = 2*bins[3]-T[12293:12305]
T[12305:12315] = 2*bins[4]-T[12305:12315]
T[12315:12318] = 2*bins[5]-T[12315:12318]
T[12318:12320] = 2*bins[6]-T[12318:12320]
T[12320:12321] = 2*bins[7]-T[12320:12321] # Ambiguous.
T[12321:12730] = T[12321:12730] # >0
T[12730:12731] = 2*bins[-3]-T[12730:12731] # Ambiguous.
T[12731:12732] = 2*bins[-4]-T[12731:12732] # Ambiguous.
T[12732:12733] = 2*bins[-5]-T[12732:12733] # Ambiguous.
T[12733:12737] = 2*bins[-6]-T[12733:12737]
T[12737:12744] = 2*bins[-7]-T[12737:12744]
T[12744:12761] = 2*bins[-8]-T[12744:12761]
T[12761:12798] = 2*bins[-9]-T[12761:12798]
T[12798:13003] = 2*bins[0]-T[12798:13003]
T[13003:13033] = 2*bins[1]-T[13003:13033]
T[13033:13049] = 2*bins[2]-T[13033:13049]
T[13049:13059] = 2*bins[3]-T[13049:13059]
T[13059:13065] = 2*bins[4]-T[13059:13065]
T[13065:13068] = 2*bins[5]-T[13065:13068]
T[13068:13069] = 2*bins[6]-T[13068:13069]
T[13069:13070] = 2*bins[7]-T[13069:13070] # Ambiguous.
T[13070:13071] = 2*bins[8]-T[13070:13071] # Very ambiguous.
T[13071:13569] = T[13071:13569] # >0
T[13569:13570] = 2*bins[-3]-T[13569:13570] # Ambiguous.
T[13570:13571] = 2*bins[-4]-T[13570:13571] # Ambiguous.
T[13571:13572] = 2*bins[-5]-T[13571:13572] # Ambiguous.
T[13572:13573] = 2*bins[-5]-T[13572:13573] # Ambiguous.
T[13573:13577] = 2*bins[-6]-T[13573:13577]
T[13577:13586] = 2*bins[-7]-T[13577:13586]
T[13586:13602] = 2*bins[-8]-T[13586:13602]
T[13602:13639] = 2*bins[-9]-T[13602:13639]
T[13639:13846] = 2*bins[0]-T[13639:13846]
T[13846:13876] = 2*bins[1]-T[13846:13876]
T[13876:13892] = 2*bins[2]-T[13876:13892]
T[13892:13902] = 2*bins[3]-T[13892:13902]
T[13902:13907] = 2*bins[4]-T[13902:13907]
T[13907:13910] = 2*bins[5]-T[13907:13910]
T[13910:13912] = 2*bins[6]-T[13910:13912]
T[13912:13913] = 2*bins[8]-T[13912:13913] # Ambiguous.
T[13913:14317] = T[13913:14317] # >0
T[14317:14318] = 2*bins[-3]-T[14317:14318] # Ambiguous.
T[14318:14320] = 2*bins[-5]-T[14318:14320]
T[14320:14324] = 2*bins[-6]-T[14320:14324]
T[14324:14332] = 2*bins[-7]-T[14324:14332]
T[14332:14348] = 2*bins[-8]-T[14332:14348]
T[14348:14382] = 2*bins[-9]-T[14348:14382]
T[14382:14596] = 2*bins[0]-T[14382:14596]
T[14596:14624] = 2*bins[1]-T[14596:14624]
T[14624:14640] = 2*bins[2]-T[14624:14640]
T[14640:14651] = 2*bins[3]-T[14640:14651]
T[14651:14657] = 2*bins[4]-T[14651:14657]
T[14657:14660] = 2*bins[5]-T[14657:14660]
T[14660:14662] = 2*bins[6]-T[14660:14662]
T[14662:14663] = 2*bins[7]-T[14662:14663] # Ambiguous.
T[14663:14664] = 2*bins[-1]-T[14663:14664] # Ambiguous.
T[14664:15069] = T[14664:15069] # >0
T[15069:15070] = 2*bins[-2]-T[15069:15070] # Ambiguous.
T[15070:15071] = 2*bins[-4]-T[15070:15071] # Ambiguous.
T[15071:15073] = 2*bins[-5]-T[15071:15073]
T[15073:15076] = 2*bins[-6]-T[15073:15076]
T[15076:15084] = 2*bins[-7]-T[15076:15084]
T[15084:15100] = 2*bins[2]-T[15084:15100]
T[15100:15138] = 2*bins[1]-T[15100:15138]
T[15138:15353] = 2*bins[0]-T[15138:15353]
T[15353:15380] = 2*bins[1]-T[15353:15380]
T[15380:15397] = 2*bins[2]-T[15380:15397]
T[15397:15409] = 2*bins[3]-T[15397:15409]
T[15409:15415] = 2*bins[4]-T[15409:15415]
T[15415:15419] = 2*bins[5]-T[15415:15419]
T[15419:15420] = 2*bins[6]-T[15419:15420] # Ambiguous.
T[15420:15421] = 2*bins[-3]-T[15420:15421] # Ambiguous.
T[15421:15422] = 2*bins[-2]-T[15421:15422] # Ambiguous.
T[15422:15827] = T[15422:15827] # >0
T[15827:15828] = 2*bins[-1]-T[15827:15828]
T[15828:15829] = 2*bins[-4]-T[15828:15829]
T[15829:15831] = 2*bins[-5]-T[15829:15831]
T[15831:15835] = 2*bins[-6]-T[15831:15835]
T[15835:15842] = 2*bins[-7]-T[15835:15842]
T[15842:15859] = 2*bins[-8]-T[15842:15859]
T[15859:15893] = 2*bins[-9]-T[15859:15893]
T[15893:16135] = 2*bins[0]-T[15893:16135]
T[16135:16160] = 2*bins[1]-T[16135:16160]
T[16160:16182] = 2*bins[2]-T[16160:16182]
T[16182:16194] = 2*bins[3]-T[16182:16194]
T[16194:16203] = 2*bins[4]-T[16194:16203]
T[16203:16206] = 2*bins[5]-T[16203:16206]
T[16206:16208] = 2*bins[6]-T[16206:16208]
T[16208:16209] = 2*bins[7]-T[16208:16209] # Ambiguous.
T[16209:16210] = 2*bins[8]-T[16209:16210] # Ambiguous.
T[16210:16594] = T[16210:16594] # >0
T[16594:16596] = 2*bins[-5]-T[16594:16596]
T[16596:16599] = 2*bins[-6]-T[16596:16599]
T[16599:16606] = 2*bins[-7]-T[16599:16606]
T[16606:16622] = 2*bins[-8]-T[16606:16622]
T[16622:16654] = 2*bins[-9]-T[16622:16654]
T[16654:16899] = 2*bins[0]-T[16654:16899]
T[16899:16928] = 2*bins[1]-T[16899:16928]
T[16928:16948] = 2*bins[2]-T[16928:16948]
T[16948:16962] = 2*bins[3]-T[16948:16962]
T[16962:16969] = 2*bins[4]-T[16962:16969]
T[16969:16973] = 2*bins[5]-T[16969:16973]
T[16973:16975] = 2*bins[-4]-T[16973:16975]
T[16975:16976] = 2*bins[-3]-T[16975:16976] # Ambiguous.
T[16976:16977] = 2*bins[-3]-T[16976:16977] # Ambiguous.
T[16977:16978] = 2*bins[-2]-T[16977:16978] # Ambiguous.
T[16978:16979] = 2*bins[-1]-T[16978:16979] # Ambiguous.
T[16979:17350] = T[16979:17350] # >0
T[17350:17351] = 2*bins[-1]-T[17350:17351] # Ambiguous.
T[17351:17352] = 2*bins[-4]-T[17351:17352] # Ambiguous.
T[17352:17354] = 2*bins[-5]-T[17352:17354]
T[17354:17358] = 2*bins[-6]-T[17354:17358]
T[17358:17365] = 2*bins[-7]-T[17358:17365]
T[17365:17381] = 2*bins[-8]-T[17365:17381]
T[17381:17416] = 2*bins[-9]-T[17381:17416]
T[17416:17633] = 2*bins[0]-T[17416:17633]
T[17633:17661] = 2*bins[1]-T[17633:17661]
T[17661:17687] = 2*bins[2]-T[17661:17687]
T[17687:17702] = 2*bins[3]-T[17687:17702]
T[17702:17710] = 2*bins[4]-T[17702:17710]
T[17710:17717] = 2*bins[5]-T[17710:17717]
T[17717:17719] = 2*bins[6]-T[17717:17719]
T[17719:17720] = 2*bins[7]-T[17719:17720] # Ambiguous.
T[17720:17721] = 2*bins[9]-T[17720:17721] # Ambiguous.
T[17721:18108] = T[17721:18108] # >0
T[18108:18109] = 2*bins[-3]-T[18108:18109] # Ambiguous.
T[18109:18112] = 2*bins[-5]-T[18109:18112]
T[18112:18116] = 2*bins[-6]-T[18112:18116]
T[18116:18124] = 2*bins[-7]-T[18116:18124]
T[18124:18140] = 2*bins[-8]-T[18124:18140]
T[18140:18175] = 2*bins[-9]-T[18140:18175]
T[18175:18427] = 2*bins[0]-T[18175:18427]
T[18427:18454] = 2*bins[1]-T[18427:18454]
T[18454:18477] = 2*bins[2]-T[18454:18477]
T[18477:18491] = 2*bins[3]-T[18477:18491]
T[18491:18499] = 2*bins[4]-T[18491:18499]
T[18499:18504] = 2*bins[5]-T[18499:18504]
T[18504:18506] = 2*bins[-4]-T[18504:18506]
T[18506:18507] = 2*bins[-3]-T[18506:18507] # Ambiguous.
T[18507:18508] = 2*bins[-2]-T[18507:18508] # Ambiguous.
T[18508:18891] = T[18508:18891] # >0
T[18891:18892] = 2*bins[-3]-T[18891:18892] # Ambiguous.
T[18892:18893] = 2*bins[-4]-T[18892:18893] # Ambiguous.
T[18893:18895] = 2*bins[-5]-T[18893:18895]
T[18895:18899] = 2*bins[-6]-T[18895:18899]
T[18899:18906] = 2*bins[-7]-T[18899:18906]
T[18906:18923] = 2*bins[-8]-T[18906:18923]
T[18923:18958] = 2*bins[-9]-T[18923:18958]
T[18958:19241] = 2*bins[0]-T[18958:19241]
T[19241:19270] = 2*bins[1]-T[19241:19270]
T[19270:19295] = 2*bins[2]-T[19270:19295]
T[19295:19316] = 2*bins[3]-T[19295:19316]
T[19316:19324] = 2*bins[4]-T[19316:19324]
T[19324:19328] = 2*bins[5]-T[19324:19328]
T[19328:19329] = 2*bins[6]-T[19328:19329] # Ambiguous.
T[19329:19330] = 2*bins[7]-T[19329:19330] # Ambiguous.
T[19330:19331] = 2*bins[8]-T[19330:19331] # Ambiguous.
T[19331:20124] = T[19331:20124] # >0
T[20124:20125] = 2*bins[-3]-T[20124:20125] # Ambiguous.
T[20125:20126] = 2*bins[-4]-T[20125:20126] # Ambiguous.
T[20126:20128] = 2*bins[-5]-T[20126:20128] # Ambiguous.
T[20128:20131] = 2*bins[-6]-T[20128:20131]
T[20131:20140] = 2*bins[-7]-T[20131:20140]
T[20140:20157] = 2*bins[-8]-T[20140:20157]
T[20157:20202] = 2*bins[-9]-T[20157:20202]
T[20202:20452] = 2*bins[0]-T[20202:20452]
T[20452:20484] = 2*bins[1]-T[20452:20484]
T[20484:20503] = 2*bins[2]-T[20484:20503]
T[20503:20517] = 2*bins[3]-T[20503:20517]
T[20517:20525] = 2*bins[4]-T[20517:20525]
T[20525:20529] = 2*bins[5]-T[20525:20529]
T[20529:20531] = 2*bins[6]-T[20529:20531]
T[20531:20532] = 2*bins[7]-T[20531:20532] # Ambiguous.
T[20532:20533] = 2*bins[8]-T[20532:20533] # Ambiguous.
T[20533:20534] = 2*bins[9]-T[20533:20534] # Ambiguous.
T[20534:20911] = T[20534:20911] # >0
T[20911:20912] = 2*bins[-2]-T[20911:20912] # Ambiguous.
T[20912:20913] = 2*bins[-4]-T[20912:20913] # Ambiguous.
T[20913:20915] = 2*bins[-5]-T[20913:20915]
T[20915:20919] = 2*bins[-6]-T[20915:20919]
T[20919:20926] = 2*bins[-7]-T[20919:20926]
T[20926:20944] = 2*bins[-8]-T[20926:20944]
T[20944:20982] = 2*bins[-9]-T[20944:20982]
T[20982:21216] = 2*bins[0]-T[20982:21216]
T[21216:21243] = 2*bins[1]-T[21216:21243]
T[21243:21262] = 2*bins[2]-T[21243:21262]
T[21262:21273] = 2*bins[3]-T[21262:21273]
T[21273:21280] = 2*bins[4]-T[21273:21280]
T[21280:21284] = 2*bins[5]-T[21280:21284]
T[21284:21285] = 2*bins[-4]-T[21284:21285] # Ambiguous.
T[21285:21286] = 2*bins[-3]-T[21285:21286] # Ambiguous.
T[21286:21287] = 2*bins[-2]-T[21286:21287] # Ambiguous.
T[21287:21670] = T[21287:21670] # >0
T[21670:21671] = 2*bins[-4]-T[21670:21671] # Ambiguous.
T[21671:21673] = 2*bins[-6]-T[21671:21673]
T[21673:21678] = 2*bins[-7]-T[21673:21678]
T[21678:21687] = 2*bins[-8]-T[21678:21687]
T[21687:21708] = 2*bins[-9]-T[21687:21708]
T[21708:21828] = 2*bins[0]-T[21708:21828]
T[21828:21844] = 2*bins[1]-T[21828:21844]
T[21844:21853] = 2*bins[2]-T[21844:21853]
T[21853:21858] = 2*bins[3]-T[21853:21858]
T[21858:21861] = 2*bins[4]-T[21858:21861]
T[21861:21863] = 2*bins[5]-T[21861:21863]
T[21863:21864] = 2*bins[-4]-T[21863:21864] # Ambiguous.
T[21864:21865] = 2*bins[-3]-T[21864:21865] # Ambiguous.
T[21865:22077] = T[21865:22077] # >0
T[22077:22078] = 2*bins[-3]-T[22077:22078] # Ambiguous.
T[22078:22080] = 2*bins[-5]-T[22078:22080]
T[22080:22082] = 2*bins[-6]-T[22080:22082]
T[22082:22086] = 2*bins[-7]-T[22082:22086]
T[22086:22094] = 2*bins[-8]-T[22086:22094]
T[22094:22113] = 2*bins[-9]-T[22094:22113]
T[22113:22221] = 2*bins[0]-T[22113:22221]
T[22221:22236] = 2*bins[1]-T[22221:22236]
T[22236:22244] = 2*bins[2]-T[22236:22244]
T[22244:22249] = 2*bins[3]-T[22244:22249]
T[22249:22252] = 2*bins[4]-T[22249:22252]
T[22252:22253] = 2*bins[-5]-T[22252:22253] # Ambiguous.
T[22253:22254] = 2*bins[-4]-T[22253:22254] # Ambiguous.
T[22254:22255] = 2*bins[-2]-T[22254:22255] # Ambiguous.
T[22255:22486] = T[22255:22486] # >0
T[22486:22487] = 2*bins[-3]-T[22486:22487] # Ambiguous.
T[22487:22488] = 2*bins[-5]-T[22487:22488] # Ambiguous.
T[22488:22492] = 2*bins[-6]-T[22488:22492]
T[22492:22496] = 2*bins[-7]-T[22492:22496]
T[22496:22507] = 2*bins[-8]-T[22496:22507]
T[22507:22526] = 2*bins[-9]-T[22507:22526]
T[22526:22641] = 2*bins[0]-T[22526:22641]
T[22641:22659] = 2*bins[1]-T[22641:22659]
T[22659:22667] = 2*bins[2]-T[22659:22667]
T[22667:22672] = 2*bins[3]-T[22667:22672]
T[22672:22674] = 2*bins[4]-T[22672:22674]
T[22674:22676] = 2*bins[5]-T[22674:22676]
T[22676:22677] = 2*bins[6]-T[22676:22677] # Very ambiguous.
T[22677:22891] = T[22677:22891] # >0
T[22891:22892] = 2*bins[-4]-T[22891:22892] # Ambiguous.
T[22892:22893] = 2*bins[-5]-T[22892:22893] # Ambiguous.
T[22893:22897] = 2*bins[-7]-T[22893:22897]
T[22897:22906] = 2*bins[-8]-T[22897:22906]
T[22906:22925] = 2*bins[-9]-T[22906:22925]
T[22925:23043] = 2*bins[0]-T[22925:23043]
T[23043:23061] = 2*bins[1]-T[23043:23061]
T[23061:23069] = 2*bins[2]-T[23061:23069]
T[23069:23074] = 2*bins[3]-T[23069:23074]
T[23074:23076] = 2*bins[4]-T[23074:23076]
T[23076:23078] = 2*bins[5]-T[23076:23078]
T[23078:23079] = 2*bins[6]-T[23078:23079] # Ambiguous.
T[23079:23080] = 2*bins[-2]-T[23079:23080] # Ambiguous.
T[23080:23295] = T[23080:23295] # >0
T[23296:23297] = 2*bins[-3]-T[23296:23297] # Ambiguous.
T[23297:23298] = 2*bins[-5]-T[23297:23298] # Ambiguous.
T[23298:23300] = 2*bins[-6]-T[23298:23300]
T[23300:23304] = 2*bins[-7]-T[23300:23304]
T[23304:23312] = 2*bins[-8]-T[23304:23312]
T[23312:23331] = 2*bins[-9]-T[23312:23331]
T[23331:23444] = 2*bins[0]-T[23331:23444]
T[23444:23458] = 2*bins[1]-T[23444:23458]
T[23458:23466] = 2*bins[2]-T[23458:23466]
T[23466:23472] = 2*bins[3]-T[23466:23472]
T[23472:23475] = 2*bins[4]-T[23472:23475]
T[23475:23476] = 2*bins[5]-T[23475:23476] # Ambiguous.
T[23476:23477] = 2*bins[6]-T[23476:23477] # Ambiguous.
T[23477:23478] = 2*bins[7]-T[23477:23478] # Ambiguous.
T[23478:23690] = T[23478:23690] # >0
T[23690:23691] = 2*bins[-3]-T[23690:23691] # Ambiguous.
T[23691:23693] = 2*bins[-5]-T[23691:23693]
T[23693:23695] = 2*bins[-6]-T[23693:23695]
T[23695:23703] = 2*bins[-7]-T[23695:23703]
T[23703:23712] = 2*bins[-8]-T[23703:23712]
T[23712:23727] = 2*bins[-9]-T[23712:23727]
T[23727:23843] = 2*bins[0]-T[23727:23843]
T[23843:23855] = 2*bins[1]-T[23843:23855]
T[23855:23865] = 2*bins[2]-T[23855:23865]
T[23865:23871] = 2*bins[3]-T[23865:23871]
T[23871:23875] = 2*bins[4]-T[23871:23875]
T[23875:23877] = 2*bins[5]-T[23875:23877]
T[23877:23878] = 2*bins[-4]-T[23877:23878] # Ambiguous.
T[23878:23879] = 2*bins[-1]-T[23878:23879] # Very ambiguous.
T[23879:24074] = T[23879:24074] # >0
T[24074:24075] = 2*bins[-3]-T[24074:24075] # Ambiguous.
T[24075:24076] = 2*bins[-5]-T[24075:24076] # Ambiguous.
T[24076:24077] = 2*bins[-6]-T[24076:24077] # Ambiguous.
T[24077:24081] = 2*bins[-7]-T[24077:24081]
T[24081:24089] = 2*bins[-8]-T[24081:24089]
T[24089:24106] = 2*bins[-9]-T[24089:24106]
T[24106:24225] = 2*bins[0]-T[24106:24225]
T[24225:24239] = 2*bins[1]-T[24225:24239]
T[24239:24249] = 2*bins[2]-T[24239:24249]
T[24249:24255] = 2*bins[3]-T[24249:24255]
T[24255:24259] = 2*bins[4]-T[24255:24259]
T[24259:24261] = 2*bins[5]-T[24259:24261]
T[24261:24262] = 2*bins[7]-T[24261:24262] # Ambiguous.
T[24262:24452] = T[24262:24452] # >0
T[24452:24453] = 2*bins[-4]-T[24452:24453] # Ambiguous.
T[24453:24454] = 2*bins[-4]-T[24453:24454] # Very ambiguous.
T[24454:24455] = 2*bins[-5]-T[24454:24455] # Ambiguous.
T[24455:24457] = 2*bins[-6]-T[24455:24457]
T[24457:24463] = 2*bins[-7]-T[24457:24463]
T[24463:24470] = 2*bins[-8]-T[24463:24470]
T[24470:24488] = 2*bins[-9]-T[24470:24488]
T[24488:24621] = 2*bins[0]-T[24488:24621]
T[24621:24635] = 2*bins[1]-T[24621:24635]
T[24635:24646] = 2*bins[2]-T[24635:24646]
T[24646:24653] = 2*bins[3]-T[24646:24653]
T[24653:24657] = 2*bins[4]-T[24653:24657]
T[24657:24659] = 2*bins[5]-T[24657:24659]
T[24659:24660] = 2*bins[6]-T[24659:24660] # Ambiguous.
T[24660:24661] = 2*bins[7]-T[24660:24661] # Ambiguous.
T[24661:25315] = T[24661:25315] # >0
T[25315:25316] = 2*bins[-4]-T[25315:25316] # Ambiguous.
T[25316:25317] = 2*bins[-5]-T[25316:25317] # Ambiguous.
T[25317:25318] = 2*bins[-6]-T[25317:25318] # Ambiguous.
T[25318:25322] = 2*bins[-7]-T[25318:25322]
T[25322:25330] = 2*bins[-8]-T[25322:25330]
T[25330:25351] = 2*bins[-9]-T[25330:25351]
T[25351:25484] = 2*bins[0]-T[25351:25484]
T[25484:25497] = 2*bins[1]-T[25484:25497]
T[25497:25509] = 2*bins[2]-T[25497:25509]
T[25509:25516] = 2*bins[3]-T[25509:25516]
T[25516:25520] = 2*bins[4]-T[25516:25520]
T[25520:25522] = 2*bins[5]-T[25520:25522]
T[25522:25523] = 2*bins[6]-T[25522:25523] # Ambiguous.
T[25523:25524] = 2*bins[7]-T[25523:25524] # Ambiguous.
T[25524:25705] = T[25524:25705] # >0
T[25705:25706] = 2*bins[-1]-T[25705:25706] # Very ambiguous.
T[25706:25707] = 2*bins[-5]-T[25706:25707] # Ambiguous.
T[25707:25710] = 2*bins[-6]-T[25707:25710]
T[25710:25714] = 2*bins[-7]-T[25710:25714]
T[25714:25722] = 2*bins[-8]-T[25714:25722]
T[25722:25739] = 2*bins[-9]-T[25722:25739]
T[25739:25861] = 2*bins[0]-T[25739:25861]
T[25861:25874] = 2*bins[1]-T[25861:25874]
T[25874:25886] = 2*bins[2]-T[25874:25886]
T[25886:25897] = 2*bins[3]-T[25886:25897]
T[25897:25901] = 2*bins[4]-T[25897:25901]
T[25901:25903] = 2*bins[5]-T[25901:25903]
T[25903:25904] = 2*bins[6]-T[25903:25904] # Ambiguous.
T[25904:25905] = 2*bins[7]-T[25904:25905] # Ambiguous.
T[25905:26091] = T[25905:26091] # >0
T[26091:26092] = 2*bins[-3]-T[26091:26092] # Very ambiguous.
T[26092:26093] = 2*bins[-5]-T[26092:26093]
T[26093:26095] = 2*bins[-6]-T[26093:26095]
T[26095:26099] = 2*bins[-7]-T[26095:26099]
T[26099:26106] = 2*bins[-8]-T[26099:26106]
T[26106:26124] = 2*bins[-9]-T[26106:26124]
T[26124:26238] = 2*bins[0]-T[26124:26238]
T[26238:26251] = 2*bins[1]-T[26238:26251]
T[26251:26262] = 2*bins[2]-T[26251:26262]
T[26262:26269] = 2*bins[3]-T[26262:26269]
T[26269:26272] = 2*bins[4]-T[26269:26272]
T[26272:26274] = 2*bins[5]-T[26272:26274]
T[26274:26275] = 2*bins[6]-T[26274:26275] # Ambiguous.
T[26275:26276] = 2*bins[7]-T[26275:26276] # Ambiguous.
T[26276:26474] = T[26276:26474] # >0
T[26474:26475] = 2*bins[-4]-T[26474:26475] # Ambiguous.
T[26475:26476] = 2*bins[-5]-T[26475:26476] # Ambiguous.
T[26476:26478] = 2*bins[-6]-T[26476:26478]
T[26478:26482] = 2*bins[-7]-T[26478:26482]
T[26482:26490] = 2*bins[-8]-T[26482:26490]
T[26490:26508] = 2*bins[-9]-T[26490:26508]
T[26508:26624] = 2*bins[0]-T[26508:26624]
T[26624:26638] = 2*bins[1]-T[26624:26638]
T[26638:26647] = 2*bins[2]-T[26638:26647]
T[26647:26653] = 2*bins[3]-T[26647:26653]
T[26653:26657] = 2*bins[4]-T[26653:26657]
T[26657:26659] = 2*bins[5]-T[26657:26659]
T[26659:26660] = 2*bins[-4]-T[26659:26660] # Ambiguous.
T[26660:26661] = 2*bins[-1]-T[26660:26661] # Very ambiguous.
T[26661:26880] = T[26661:26880] # >0
T[26880:26881] = 2*bins[-4]-T[26880:26881] # Ambiguous.
T[26881:26882] = 2*bins[-5]-T[26881:26882] # Ambiguous.
T[26882:26883] = 2*bins[-6]-T[26882:26883]
T[26883:26888] = 2*bins[-7]-T[26883:26888]
T[26888:26897] = 2*bins[-8]-T[26888:26897]
T[26897:26917] = 2*bins[-9]-T[26897:26917]
T[26917:27018] = 2*bins[0]-T[26917:27018]
T[27018:27033] = 2*bins[1]-T[27018:27033]
T[27033:27041] = 2*bins[2]-T[27033:27041]
T[27041:27046] = 2*bins[3]-T[27041:27046]
T[27046:27049] = 2*bins[4]-T[27046:27049]
T[27049:27051] = 2*bins[-5]-T[27049:27051]
T[27051:27052] = 2*bins[-3]-T[27051:27052] # Ambiguous.
T[27052:27254] = T[27052:27254] # >0
T[27254:27255] = 2*bins[-4]-T[27254:27255] # Ambiguous.
T[27255:27256] = 2*bins[-5]-T[27255:27256] # Ambiguous.
T[27256:27258] = 2*bins[-6]-T[27256:27258]
T[27258:27262] = 2*bins[-7]-T[27258:27262]
T[27262:27270] = 2*bins[-8]-T[27262:27270]
T[27270:27291] = 2*bins[-9]-T[27270:27291]
T[27291:27395] = 2*bins[0]-T[27291:27395]
T[27395:27413] = 2*bins[1]-T[27395:27413]
T[27413:27423] = 2*bins[2]-T[27413:27423]
T[27423:27429] = 2*bins[3]-T[27423:27429]
T[27429:27432] = 2*bins[4]-T[27429:27432]
T[27432:27433] = 2*bins[5]-T[27432:27433]
T[27433:27434] = 2*bins[6]-T[27433:27434] # Ambiguous.
T[27434:27435] = 2*bins[7]-T[27434:27435] # Ambiguous.
T[27435:27651] = T[27435:27651] # >0
T[27651:27652] = 2*bins[-3]-T[27651:27652] # Ambiguous.
T[27652:27653] = 2*bins[-5]-T[27652:27653] # Ambiguous.
T[27653:27655] = 2*bins[-6]-T[27653:27655]
T[27655:27659] = 2*bins[-7]-T[27655:27659]
T[27659:27667] = 2*bins[-8]-T[27659:27667]
T[27667:27687] = 2*bins[-9]-T[27667:27687]
T[27687:27785] = 2*bins[0]-T[27687:27785]
T[27785:27803] = 2*bins[1]-T[27785:27803]
T[27803:27808] = 2*bins[2]-T[27803:27808]
T[27808:27813] = 2*bins[3]-T[27808:27813]
T[27813:27815] = 2*bins[4]-T[27813:27815]
T[27815:27817] = 2*bins[-5]-T[27815:27817]
T[27817:27818] = 2*bins[-3]-T[27817:27818] # Ambiguous.
T[27818:28032] = T[27818:28032] # >0
T[28032:28033] = 2*bins[-4]-T[28032:28033] # Ambiguous.
T[28033:28034] = 2*bins[-5]-T[28033:28034] # Ambiguous.
T[28034:28036] = 2*bins[-6]-T[28034:28036]
T[28036:28040] = 2*bins[-7]-T[28036:28040]
T[28040:28048] = 2*bins[-8]-T[28040:28048]
T[28048:28067] = 2*bins[-9]-T[28048:28067]
T[28067:28173] = 2*bins[0]-T[28067:28173]
T[28173:28190] = 2*bins[1]-T[28173:28190]
T[28190:28197] = 2*bins[2]-T[28190:28197]
T[28197:28202] = 2*bins[3]-T[28197:28202]
T[28202:28206] = 2*bins[4]-T[28202:28206]
T[28206:28207] = 2*bins[-5]-T[28206:28207] # Ambiguous.
T[28207:28208] = 2*bins[-5]-T[28207:28208] # Ambiguous.
T[28208:28209] = 2*bins[-5]-T[28208:28209] # Very ambiguous.
T[28209:28210] = 2*bins[-4]-T[28209:28210] # Ambiguous.
T[28210:28428] = T[28210:28428] # >0
T[28428:28429] = 2*bins[-2]-T[28428:28429] # Very ambiguous.
T[28429:28430] = 2*bins[-4]-T[28429:28430] # Ambiguous.
T[28430:28431] = 2*bins[-5]-T[28430:28431]
T[28431:28433] = 2*bins[-6]-T[28431:28433]
T[28433:28437] = 2*bins[-7]-T[28433:28437]
T[28437:28445] = 2*bins[-8]-T[28437:28445]
T[28445:28463] = 2*bins[-9]-T[28445:28463]
T[28463:28577] = 2*bins[0]-T[28463:28577]
T[28577:28591] = 2*bins[1]-T[28577:28591]
T[28591:28601] = 2*bins[2]-T[28591:28601]
T[28601:28606] = 2*bins[3]-T[28601:28606]
T[28606:28609] = 2*bins[4]-T[28606:28609]
T[28609:28611] = 2*bins[5]-T[28609:28611]
T[28611:28612] = 2*bins[7]-T[28611:28612] # Ambiguous.
T[28612:28812] = T[28612:28812] # >0
T[28812:28813] = 2*bins[-3]-T[28812:28813] # Ambiguous.
T[28813:28814] = 2*bins[-5]-T[28813:28814] # Ambiguous.
T[28814:28815] = 2*bins[-6]-T[28814:28815] # Ambiguous.
T[28815:28816] = 2*bins[-6]-T[28815:28816]
T[28816:28820] = 2*bins[-7]-T[28816:28820]
T[28820:28828] = 2*bins[-8]-T[28820:28828]
T[28828:28845] = 2*bins[-9]-T[28828:28845]
T[28845:28912] = 2*bins[0]-T[28845:28912] # END

plt.close('all')
plt.figure()
plt.plot(Time,T,'.')
plt.ylim([-4,5])
plt.xlabel('Time')
plt.ylabel('Temp')
plot_rollovers()

import csv
a = np.array(data['a15']['p1'][1]['T'])
a[ix]=T
b = np.vstack((np.array(data['a15']['p1'][1]['Time']),a,
                                        np.array(data['a15']['p1'][1]['dT'])))
outfile = 'a15p1.file_1.corrected'
spreadsheet = csv.writer(open(outfile, 'w'), delimiter=' ',
                                quotechar='|', quoting=csv.QUOTE_MINIMAL)
spreadsheet.writerows(b.T)
